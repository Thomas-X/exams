{"version":3,"sources":["webpack:///webpack/bootstrap aea77bba7c9e7a3c89c5","webpack:///external \"express\"","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"chalk\"","webpack:///external \"mongoose\"","webpack:///./src/global/models/User.js","webpack:///./src/index.js","webpack:///external \"regenerator-runtime\"","webpack:///external \"body-parser\"","webpack:///external \"http\"","webpack:///external \"ip\"","webpack:///./src/controllers/auth.js","webpack:///external \"bcrypt\"","webpack:///external \"express-validator/check\"","webpack:///external \"is-js\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"uuid/v4\"","webpack:///./src/controllers/home.js","webpack:///./src/controllers/login.js","webpack:///./src/controllers/register.js","webpack:///./src/factories/createAuthHandler.js","webpack:///external \"passport\"","webpack:///external \"passport-jwt\"","webpack:///./src/services/log.js","webpack:///external \"stack-trace\"","webpack:///./src/socket.js","webpack:///external \"socket.io\"","webpack:///external \"morgan\"","webpack:///external \"cookie-parser\"","webpack:///external \"path\"","webpack:///external \"serve-favicon\"","webpack:///external \"dotenv\""],"names":["schema","mongoose","Schema","id","type","String","required","unique","username","maxLength","password","User","model","require","config","Server","onListen","err","error","port","process","env","__DEV__","warn","info","ip","address","toString","connectToDb","connect","useMongoClient","Promise","global","db","connection","on","console","log","Error","once","start","catch","app","set","path","join","__dirname","use","favicon","bodyParser","json","urlencoded","extended","logger","cookieParser","express","static","createAuthHandler","setRoutes","http","socket","bindSockets","listen","req","res","next","passParametersToTemplate","obj","activeLinks","send","setupEndMiddleware","status","PORT","Auth","Router","validations","check","exists","isAlphanumeric","isLength","min","post","errors","validationResult","isEmpty","mapped","body","find","user","is","uuid","hash","Number","salt","create","token","sign","sub","secretKey","cookie","compare","Home","get","render","title","Login","Register","cookieExtractor","cookies","options","jwtFromRequest","ignoreExpiration","secretOrKey","passport","jwtPayload","done","authMiddleware","authenticate","session","misc","message","DEBUG","content","trace","funcName","getFunctionName","substr","rest","debug","Socket","io"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap aea77bba7c9e7a3c89c5","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 1\n// module chunks = 0","module.exports = require(\"chalk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"chalk\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 3\n// module chunks = 0","import mongoose from 'mongoose';\n\nconst schema = new mongoose.Schema({\n    id: { type: String, required: true, unique: true },\n    username: { type: String, maxLength: 255, required: true, unique: true },\n    password: { type: String, maxLength: 255, required: true },\n});\n\nconst User = mongoose.model('User', schema);\n\nexport default User;\n\n\n\n// WEBPACK FOOTER //\n// ./src/global/models/User.js","import bodyParser from 'body-parser';\nimport chalk from 'chalk';\nimport cookieParser from 'cookie-parser';\nimport express from 'express';\nimport { Server as HttpServer } from 'http';\nimport ip from 'ip';\nimport mongoose from 'mongoose';\nimport logger from 'morgan';\nimport path from 'path';\nimport favicon from 'serve-favicon';\nimport Auth from './controllers/auth';\nimport Home from './controllers/home';\nimport Login from './controllers/login';\nimport Register from './controllers/register';\nimport createAuthHandler, { authMiddleware } from './factories/createAuthHandler';\nimport { error, info, warn } from './services/log';\nimport Socket from './socket';\n\nrequire('dotenv').config();\n\nclass Server {\n    app;\n    port;\n\n    constructor () {\n\n        this.app = express();\n        this.port = process.env.PORT || 3000;\n        this.connectToDb()\n            .catch(err => error(err));\n    }\n\n    onListen = (err) => {\n        if (err) {\n            error(`Unable to start server on port ${this.port}`, err);\n            return;\n        }\n\n        if (process.env.__DEV__) {\n            warn('We\\'re in development mode.');\n        }\n\n        info(`We're live.\\r\\n`);\n        info(chalk`{bold On your network:}     {underline http://${ip.address('public')}:{bold ${this.port.toString()}}/}`);\n        info(chalk`Local:               {underline http://${ip.address('private')}:{bold ${this.port.toString()}}/}`);\n    };\n\n    connectToDb = async () => {\n        try {\n            mongoose.connect('mongodb://127.0.0.1/test', {\n                useMongoClient: true,\n            });\n            mongoose.Promise = global.Promise;\n            const db = mongoose.connection;\n\n            db.on('error', (err) => {\n                console.log();\n                error(err);\n                throw new Error(err);\n            });\n            db.once('open', () => {\n                info('Successfully connected to database!');\n                console.log();\n                this.start()\n                    .catch(err => {\n                        console.log();\n                        error(err);\n                        throw new Error(err);\n                    });\n            });\n        } catch (err) {\n            throw new Error(err);\n        }\n    };\n\n    start = async () => {\n        // view engine setup\n        this.app.set('views', path.join(__dirname, '../views'));\n        this.app.set('view engine', 'pug');\n\n        // TODO Replace favicon\n        // uncomment after placing your favicon in /public\n        this.app.use(favicon(path.join(__dirname, '../public', 'favicon.ico')));\n\n        // Set up middlewares\n        this.app.use(bodyParser.json());\n        this.app.use(bodyParser.urlencoded({ extended: false }));\n        this.app.use(logger('dev'));\n        this.app.use(cookieParser());\n        this.app.use(express.static(path.join(__dirname, '../public')));\n\n        createAuthHandler();\n        this.setRoutes();\n        const http = new HttpServer(this.app);\n        this.socket = new Socket(http);\n        this.socket.bindSockets();\n        http.listen(this.port, this.onListen);\n    };\n\n    setRoutes = () => {\n\n        this.app.use((req, res, next) => {\n            req.passParametersToTemplate = (obj) => {\n                obj.activeLinks = {};\n                obj.activeLinks[req.path] = true;\n                return obj;\n            };\n            next();\n        });\n\n        // POST register POST login\n        this.app.use('/account', Auth);\n        // GET account(login) page\n        this.app.use('/account', Login);\n        // GET account(register) page\n        this.app.use('/account', Register);\n        // GET home\n        this.app.use('/', Home);\n\n        // authed route with middleware\n        this.app.use('/someAuthedRoute', authMiddleware, (req, res) => {\n            res.send('hi from auth route');\n        });\n\n        this.setupEndMiddleware();\n    };\n\n    setupEndMiddleware = () => {\n        // catch 404 and forward to error handler\n        this.app.use(function (req, res, next) {\n            const err = new Error('Not Found');\n            err.status = 404;\n            next(err);\n        });\n    };\n}\n\nexport default new Server();\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"ip\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ip\"\n// module id = 10\n// module chunks = 0","import { compare, hash } from 'bcrypt';\nimport { Router } from 'express';\nimport { check, validationResult } from 'express-validator/check';\nimport is from 'is-js';\nimport { sign } from 'jsonwebtoken';\nimport uuid from 'uuid/v4';\nimport User from '../global/models/User';\n\nconst Auth = Router();\n\nconst validations = [\n    check('username').exists().isAlphanumeric(), // todo check existence of username in db\n    check('password').exists().isLength({ min: 8 }),\n];\n\nAuth.post('/register', validations, async (req, res, next) => {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n        return res.status(422).json({ errors: errors.mapped() });\n    }\n    try {\n        const { username, password } = req.body;\n        const user = (await User.find({ username: username }))[0];\n        if (is.set(user)) {\n            throw new Error('User already exists');\n        } else if (!is.set(user)) {\n            const id = uuid();\n            const user = {\n                id,\n                username,\n                password: await hash(password, Number(process.env.salt)),\n            };\n            await User.create(user);\n\n            // Set cookies and send token via JSON as well.\n\n            const token = sign({ sub: id }, process.env.secretKey);\n\n            res.cookie('jwt', token);\n\n            return res.json({\n                token: sign({ sub: id }, process.env.secretKey),\n            });\n        }\n    } catch (err) {\n        next(err);\n    }\n});\n\nAuth.post('/login', validations, async (req, res, next) => {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n        return res.status(422).json({ errors: errors.mapped() });\n    }\n    try {\n        const { username, password } = req.body;\n        const user = (await User.find({ username: username }))[0];\n        if (!user) {\n            throw new Error('User does not exist');\n        }\n        if (!await compare(password, user.password)) {\n            throw new Error('Incorrect password');\n        }\n\n        // Set cookies and send token via JSON as well.\n\n        const token = sign({ sub: user.id }, process.env.secretKey);\n\n        res.cookie('jwt', token);\n\n        return res.json({\n            token: sign({ sub: user.id }, process.env.secretKey),\n        });\n\n    } catch (err) {\n        next(err);\n    }\n});\n\nexport default Auth;\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/auth.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"express-validator/check\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-validator/check\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"is-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"is-js\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"uuid/v4\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid/v4\"\n// module id = 16\n// module chunks = 0","import { Router } from 'express';\n\nconst Home = Router();\n\nHome.get('/',(req, res, next) => {\n    res.render('index', req.passParametersToTemplate({title: 'bla'}));\n});\n\nexport default Home;\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/home.js","import { Router } from 'express';\n\nconst Login = Router();\n\nLogin.get('/login',(req, res, next) => {\n\n    res.render('login', req.passParametersToTemplate({\n        title: 'bla',\n\n    }));\n});\n\nexport default Login;\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/login.js","import { Router } from 'express';\n\nconst Register = Router();\n\nRegister.get('/register',(req, res, next) => {\n    res.render('register', req.passParametersToTemplate({title: 'bla'}));\n});\n\nexport default Register;\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/register.js","import passport from 'passport';\nimport { ExtractJwt, Strategy } from 'passport-jwt';\nimport User from '../global/models/User';\n\nconst cookieExtractor = (req) => {\n    let token = null;\n    if(req && req.cookies) {\n        token = req.cookies['jwt'];\n    }\n    return token;\n};\n\nexport default () => {\n    const options = {\n        jwtFromRequest: cookieExtractor,\n        ignoreExpiration: true,\n        secretOrKey: process.env.secretKey,\n    };\n\n    passport.use(new Strategy(options, async (jwtPayload, done) => {\n        const user = (await User.find({ id: jwtPayload.sub }))[0];\n        if (user) {\n            return done(null, user);\n        } else {\n            return done(null, false);\n        }\n    }));\n}\n\nexport const authMiddleware = passport.authenticate('jwt', { session: false });\n\n\n// WEBPACK FOOTER //\n// ./src/factories/createAuthHandler.js","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"passport-jwt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-jwt\"\n// module id = 22\n// module chunks = 0","import chalk from 'chalk';\nimport { get } from 'stack-trace';\n\nconst log = (type = 'log', message, ...misc) => {\n    if (type === 'debug' && process.env.DEBUG !== 'true') {\n        return;\n    }\n    let content = [];\n    switch (type) {\n        case 'log':\n            content = [chalk`{bold.cyan INFO}`];\n            break;\n        case 'error':\n            content = [chalk`{bold.red ERR!}`];\n            break;\n        case 'warn':\n            content = [chalk`{bold.yellow WARN}`];\n            break;\n        case 'debug': {\n            const trace = get();\n            const funcName = trace[2].getFunctionName();\n            content = [chalk`{bold.magenta VERB} ${funcName ? chalk`{bgBlack.white  ${funcName.substr(0, 15)} }` : ''}`];\n            break;\n        }\n        default:\n            throw new Error(`Invalid log type: ${type}`);\n    }\n\n    content = [...content, message, ...misc];\n\n    console[type === 'debug' ? 'log' : type](...content);\n};\n\nexport const info = (message, ...rest) => log('log', message, ...rest);\nexport const error = (message, ...rest) => log('error', message, ...rest);\nexport const warn = (message, ...rest) => log('warn', message, ...rest);\nexport const debug = (message, ...rest) => log('debug', message, ...rest);\n\n\n// WEBPACK FOOTER //\n// ./src/services/log.js","module.exports = require(\"stack-trace\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"stack-trace\"\n// module id = 24\n// module chunks = 0","import io from 'socket.io';\n\nexport default class Socket {\n\n    constructor (http) {\n        this.io = io(http);\n    }\n\n    bindSockets () {\n        // bind sockets here\n        // samples\n        // this.io.emit('bla', {bla: 'bla' });\n        // this.io.on('bla', (data) => { info(data) });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/socket.js","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 26\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"serve-favicon\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"serve-favicon\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 31\n// module chunks = 0"],"sourceRoot":""}